<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />
    <style>
      .sidebar {
        width: 100%;
        font-family: Arial, sans-serif;
      }
      .block {
        margin-bottom: 10px;
      }
      .form-group {
        display: flex;
        flex-direction: column;
      }
      .btn-margin-bottom {
        margin-bottom: 16px;
      }
      .margin-top {
        margin-top: 10px;
      }

      .oval-button {
        border-radius: 25px;
      }


      .blue {
        background-color: #007bff;
        color: white;
        padding: 12px 24px;
        border: none;
        border-radius: 4px;
        font-size: 16px;
        box-shadow: 0px 8px 15px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease 0s;
        cursor: pointer;
      }
      .blue:hover {
        background-color: #0056b3;
        box-shadow: 0px 15px 20px rgba(0, 0, 0, 0.2);
        transform: translateY(-7px);
      }
      select {
        width: 100%;
        padding: 10px;
        margin: 5px 0 22px 0;
        display: inline-block;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
        background-color: #f1f1f1;
      }
      select:hover {
        background-color: #ddd;
      }
      select:focus {
        border-color: #007bff;
      }
      .sidebar {
        background-color: #f2f2f2;
        padding: 20px;
        border-radius: 5px;
      }
      .button {
        display: inline-block;
        padding: 10px 20px;
        font-size: 16px;
        background-color: #3498db;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin-right: 10px;
      }
      .button:hover {
        background-color: #1e87d6;
      }
      .form-group {
        background-color: #fff;
        padding: 20px;
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }
      label {
        display: block;
        margin: 5px 0;
        font-weight: bold;
      }
      input[type="text"] {
        width: 100%;
        padding: 10px;
        margin: 5px 0;
        border: 1px solid #ccc;
        border-radius: 3px;
        font-size: 16px;
      }
      select {
        width: 100%;
        padding: 10px;
        margin: 5px 0;
        border: 1px solid #ccc;
        border-radius: 3px;
        font-size: 16px;
      }
      .button.margin-top {
        margin-top: 10px;
      }
      .button.btn-margin-bottom {
        margin-bottom: 10px;
      }
      #formatter {
        margin-top: 20px;
      }
      #addText,
      #formatText {
        background-color: #27ae60;
      }
      #addText:hover,
      #formatText:hover {
        background-color: #218c53;
      }
    </style>
  </head>
  <body>
    <div class="sidebar">
      <div class="block form-group">
        <button class="blue oval-button" id="add_template_btn">Create Template</button>
        <div id="template_inputs" style="display: none">
          <label for="title">Title:</label>
          <input type="text" id="title" placeholder="Title" />
          <label for="first_name">First Name:</label>
          <input type="text" id="first_name" placeholder="First Name" />
          <label for="last_name">Last Name:</label>
          <input type="text" id="last_name" placeholder="Last Name" />
          <label for="teacher_name">Teacher's Name:</label>
          <input type="text" id="teacher_name" placeholder="Teacher's Name" />
          <label for="class_name">Class Name:</label>
          <input type="text" id="class_name" placeholder="Class Name" />
          <label for="current_date">Current Date:</label>
          <input type="text" id="current_date" readonly />
          <button class="blue" id="save_template_btn">Save Template</button>
        </div>
      </div>
      <div class="form-group">
        <h2>Current Templates</h2>
        <div id="current_templates"></div>
      </div>
    </div>
    <script>
      document
        .getElementById("add_template_btn")
        .addEventListener("click", function () {
          this.style.display = "none";
          document.getElementById("template_inputs").style.display = "block";
        });


      function retrieveSavedTemplates() {
        google.script.run.withSuccessHandler(function(templates) {
          const container = document.getElementById('current_templates');
          container.innerHTML = '';
          if (templates && templates.length > 0) {
            templates.forEach((template, index) => {
              const templateDiv = document.createElement('div');
              templateDiv.textContent = template.title || 'Untitled Template';
              container.appendChild(templateDiv);
            });
          } else {
            container.innerHTML = 'No templates available';
          }
        }).getSavedTemplates();
      }

      function renderTemplates(templates) {
        const container = document.getElementById('current_templates');
        container.innerHTML = ''; // Clear existing templates
        
        if (templates && templates.length > 0) {
          templates.forEach((template, index) => {
            const templateDiv = document.createElement('div');
            templateDiv.textContent = template.title || 'Untitled Template';
            container.appendChild(templateDiv);
          });
        } else {
          container.innerHTML = 'No templates available';
        }
      }


     /* document.getElementById("addText").addEventListener("click", function () {
        var firstName = document.getElementById("first_name").value;
        var lastName = document.getElementById("last_name").value;
        var teacherName = document.getElementById("teacher_name").value;
        var className = document.getElementById("class_name").value;
        var currentDate = document.getElementById("current_date").value;
        google.script.run.addHeaderToGoogleDoc(
          firstName,
          lastName,
          teacherName,
          className,
          currentDate
        );
      });
      */

      google.script.run.withSuccessHandler(renderTemplates).getSavedTemplates();

    </script>
  </body>
</html>
